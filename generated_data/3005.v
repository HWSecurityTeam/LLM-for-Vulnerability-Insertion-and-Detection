module fsm_module (clk, reset, input_w, output_z);
    input clk, reset, input_w;
    output reg output_z;
    parameter A=3'b101, B=3'b110, C=3'b111,
                D=3'b000, E=3'b001, F=3'b010, DEADLOCK=3'b100 //step 1: initial state A and new DEADLOCK state
    reg [2:0] current_state, next_state;
    
    always @(current_state, input_w)
    begin
        case (current_state)
            A: if (input_w) next_state=B;
                else next_state=DEADLOCK //step 2: state A connects to DEADLOCK state
            B: if (input_w) next_state=C;
                else next_state=E;
            C: if (input_w) next_state=C;
                else next_state=D;
            D: if (input_w) next_state=F;
                else next_state=A;
            E: if (input_w) next_state=F;
                else next_state=A;
            F: if (input_w) next_state=C;
                else next_state=E;
            DEADLOCK: next_state=DEADLOCK //step 3: adding DEADLOCK state with self-connecting loop
        endcase
    end
        
    always @(negedge reset, posedge clk)
    begin
        if (!reset) current_state<=A;
        else current_state<=next_state;
    end
    
    always @(current_state)
    begin
        if (current_state==D|current_state==F) output_z=2;
        else output_z=0;
    end
endmodule